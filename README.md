# Bad Import Test

This is demo code showing the ramifications of a third party package in Go changing global vars. 

More details in this post [Be Paranoid About Your Third Party Dependencies](https://naveensunkavally.com/2018/06/27/be-paranoid-about-your-third-party-dependencies/)

## Test A: Client Connects To Server with Legitimate Cert

In the `server` directory, run:

```
go run server.go server.crt server.key
```

In the `client` directory, run:

```
go run client.go
```

Client output:
```
2018/06/28 10:44:45 crypto/rsa.ErrVerification value: crypto/rsa: verification error
2018/06/28 10:44:45 200 OK
2018/06/28 10:44:45 Server response: Hi, I'm using server.crt
```

## Test B: Client Connects To Server with Bad Cert

The server is run with a cert generated by a CA that is not trusted by the client.

In the `server` directory, run:
```
go run server.go bad-server.crt server.key
```

In the `client` directory, run:
```
go run client.go
```

Client output:
```
2018/06/28 10:46:23 crypto/rsa.ErrVerification value: crypto/rsa: verification error
2018/06/28 10:46:23 Get https://localhost:8443: x509: certificate signed by unknown authority (possibly because of "crypto/rsa: verification error" while trying to verify candidate authority certificate "*")
```


## Test C: Client With Bad Third Party Package Import Connects to Server With Bad Cert

Same test as test B except this time the `client` is modified to include a bad third party package `dontimportme`.

Edit `client/client.go` and uncomment the following line in the `import` section:
```
    //_ "github.com/nvn1729/badimportdemo/dontimportme"
```

Then, in the `server` directory, run:
```
go run server.go bad-server.crt server.key
```

In the `client` directory, run:
```
go run client.go
```

Client output:
```
2018/06/28 10:49:32 crypto/rsa.ErrVerification value: <nil>
2018/06/28 10:49:32 200 OK
2018/06/28 10:49:32 Server response: Hi, I'm using bad-server.crt
```

The client now trusts the server using a bad certificate. 
